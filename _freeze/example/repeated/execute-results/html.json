{
  "hash": "f4aca138a308ff2d43e57c2c86e937c4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Repeated measure ANOVA\"\ntype: docs\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\nThe following demonstration explains how to compute repeated measures ANOVA that include within-subject factors. Download the [**R** code](/example/repeated.R) or the [SPSS code](/example/repeated.sps). Such models can also be fitted using linear mixed models, see the [**R** code](/example/repeatedwmixedmodels.R) or the [SPSS code](/example/repeatedwmixedmodels.sps) for a demonstration.\n\n\n# Example 1\n\nWe consider Experiment 3 from @Hatano:2022. The data consist in a two by two mixed analysis of variance. The authors studied engagement and enjoyment from waiting tasks, and \"potential effects of time interval on the underestimation of task motivation by manipulating the time for the waiting task\". The waiting time was randomly assigned to either short (3 minutes) or long (20 minutes) with equal probability, but participants were either told that there was a 70% chance of being assigned to the short session, or 30% chance.\n\n## Data \n\nWe first load the data from the package and inspect the content.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(HOSM22_E3, package = \"hecedsm\")\nstr(HOSM22_E3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'tbl_df', 'tbl' and 'data.frame':\t126 obs. of  4 variables:\n $ id        : Factor w/ 63 levels \"1\",\"2\",\"3\",\"4\",..: 1 1 2 2 3 3 4 4 5 5 ...\n $ waiting   : Factor w/ 2 levels \"long\",\"short\": 2 2 1 1 1 1 2 2 1 1 ...\n $ ratingtype: Factor w/ 2 levels \"experience\",\"prediction\": 2 1 2 1 2 1 2 1 2 1 ...\n $ imscore   : num  2.33 3.33 1.25 1.92 1 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nwith(HOSM22_E3, table(waiting)/2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nwaiting\n long short \n   32    31 \n```\n\n\n:::\n:::\n\n\n\n\nFrom this, we can see that there each student is assigned to a single waiting time, but that they have both rating types. Since there are 63 students, the study is unbalanced but by a single person; this may be due to exclusions.\n\n## Model fitting\n\nWe use the `afex` package (analysis of factorial design) with the `aov_ez`. We need to specify the identifier of the subjects (`id`), the response variable (`dv`) and both between- (`between`) and within-subject (`within`) factors. Each of those names must be quoted (strings)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))\nfmod <- afex::aov_ez(id = \"id\", \n                     dv = \"imscore\", \n                     between = \"waiting\",\n                     within = \"ratingtype\",\n                     data = HOSM22_E3)\nanova(fmod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type 3 tests)\n\nResponse: imscore\n                   num Df den Df     MSE       F      ges    Pr(>F)    \nwaiting                 1     61 2.48926 11.2551 0.126246   0.00137 ** \nratingtype              1     61 0.68953 38.4330 0.120236 5.388e-08 ***\nwaiting:ratingtype      1     61 0.68953  0.0819 0.000291   0.77575    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# MANOVA tests\nfmod$Anova\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nType III Repeated Measures MANOVA Tests: Pillai test statistic\n                   Df test stat approx F num Df den Df    Pr(>F)    \n(Intercept)         1   0.89286   508.37      1     61 < 2.2e-16 ***\nwaiting             1   0.15577    11.26      1     61   0.00137 ** \nratingtype          1   0.38652    38.43      1     61 5.388e-08 ***\nwaiting:ratingtype  1   0.00134     0.08      1     61   0.77575    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\nThe output includes the $F$-tests for the two main effects and the interaction and global effect sizes $\\widehat{\\eta}^2$ (`ges`). There is no output for tests of sphericity, since there are only two measurements per person and thus a single mean different within-subject (so the test to check equality doesn't make sense with a single number). We could however compare variance between groups using Levene's test\n\nNotice that the degrees of freedom for the denominator of the test are based on the number of participants, here 63.\n\n\n# Example 2\n\n\nStudy 5 of @Halevy.Berson:2022 aimed to demonstrate that events in the distant future rather than the near future influenced the prospect of peace, along with the degree of abstractness. The experimental design is a \n\n> 2 (current state: war vs. peace) by 2 (predicted outcome: war vs. peace) by 2 (temporal distance: next year vs. twenty years into the future) mixed design\n\nwith current state and predicted outcome as between-subject factors and temporal distance as within-subject factor. The response is the estimated likelihood of each outcome on a 7-point Likert scale ranging from extremely unlikely (1) to extremely likely (7). Data are presented in long-format. The question asked was of the form \n\n>There is currently [war/peace] between the two tribes in Velvetia. Thinking about [next year/in 20 years], how likely is it that there will be [war/peace] in Velvetia?\n\n\nWe begin by loading the data and looking at the repartition of the measurements over conditions for the between-subject factors:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(HB22_S5, package = \"hecedsm\")\nxtabs(~ curstate + predout, data = HB22_S5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        predout\ncurstate peace war\n   peace   148 164\n   war     118 124\n```\n\n\n:::\n:::\n\n\n\n\nThe data is unbalanced, but there are sufficient measurements in each condition.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmmod <- afex::aov_ez(\n  id = \"id\",\n  dv = \"likelihood\",\n  between = c(\"curstate\",\"predout\"),\n  within = \"tempdist\",\n  data = HB22_S5)\nsummary(mmod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nUnivariate Type III Repeated-Measures ANOVA Assuming Sphericity\n\n                           Sum Sq num Df Error SS den Df   F value    Pr(>F)\n(Intercept)               10889.5      1   753.70    273 3944.2942 < 2.2e-16\ncurstate                      5.4      1   753.70    273    1.9614   0.16250\npredout                       0.0      1   753.70    273    0.0145   0.90412\ncurstate:predout            118.3      1   753.70    273   42.8676 2.893e-10\ntempdist                     25.8      1   357.03    273   19.7287 1.298e-05\ncurstate:tempdist             1.8      1   357.03    273    1.3894   0.23953\npredout:tempdist              8.6      1   357.03    273    6.5621   0.01095\ncurstate:predout:tempdist   365.4      1   357.03    273  279.3782 < 2.2e-16\n                             \n(Intercept)               ***\ncurstate                     \npredout                      \ncurstate:predout          ***\ntempdist                  ***\ncurstate:tempdist            \npredout:tempdist          *  \ncurstate:predout:tempdist ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\nAgain, there is no output for the test of sphericity and no difference with the multivariate analysis of variance model because each measurement per person has it's own variance and correlation parameter, but there is a single comparison for the likelihood scores (for the temporal distance).\n\nSince the three-way interaction is statistically significant, we need to compare each cell within the levels of the other factor: for example, we could fix the temporal horizon to 1 year and compare the predictions based on both current state and predicted outcome.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nlibrary(ggplot2)\nemm <- emmeans(mmod, \n               specs = c(\"curstate\",\"predout\"),\n               by = \"tempdist\")\nemmip(emm, \n      formula = curstate ~ predout | tempdist,\n      CIs = TRUE) +\n  theme_classic() + \n  theme(legend.position = \"bottom\") +\n  labs(x = \"predicted output\",\n       color = \"current state\")\n```\n\n::: {.cell-output-display}\n![](repeated_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\nThe interaction plot suggest quite strongly that the difference in the reaction is much more pronounced score-wise for short-term horizon predictions than for the long-run. The authors commented this finding by stating\n\n> when the current state is characterized by war (intergroup conflict), peace is seen as significantly more likely in the distant future than in the near future. In contrast, when the current state is characterized by peace, war is seen as significantly more likely in the distant future than in the near future.\n\n\n\n",
    "supporting": [
      "repeated_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}