{
  "hash": "ca422bf4710a7e73c56e1ad39ba34108",
  "result": {
    "markdown": "---\ntitle: \"Moderated mediation\"\ntype: docs\neditor_options: \n  chunk_output_type: console\n---\n\n\nThis example from @Roczniewska.Higgins:2019 is an instance of moderated mediation model with two postulated mediators. While such models can be fitted with the PROCESS macros [@Hayes:2022], we illustrate below the postulated causal diagram, the nonparametric bootstrap. We pay particular attention to verification of the linear model assumptions.\n\nThe context of the research is a natural experiment (or quasi-experiment): the authors study changes in behaviour due to modifications in the schooling system.\n\nThe statistical model in @Roczniewska.Higgins:2019 can be implicitly deduced from Table 2: the manipulated variable is the message framing and there are three postulated mediators (message fluency, message engagement, process fairness), the latter of which interacts or moderate with the change in outcome, and two moderators assumed to impact both mediators through linear interactions, termed promotion focus and prevention focus.\n\nThe mean response from the linear models are \n\n$$\n\\begin{align}\n\\mathsf{E}(\\texttt{PF}) &= \\alpha_0 + \\alpha_1 \\texttt{Fram} + \\alpha_2\\texttt{Prom} + \\alpha_3 \\texttt{Prev}\\\\&\\quad  + \\alpha_4 \\texttt{Fram}\\times\\texttt{Prom} +  \\alpha_5 \\texttt{Fram}\\times\\texttt{Prev}\n\\end{align}\n$$ {#eq-mediator1}\n\n$$\n\\begin{align}\n\\mathsf{E}(\\texttt{ME}) &= \\beta_0 + \\beta_1 \\texttt{Fram} + \\beta_2\\texttt{Prom} + \\beta_3 \\texttt{Prev}\\\\&\\quad  + \\beta_4 \\texttt{Fram}\\times\\texttt{Prom} +  \\beta_5 \\texttt{Fram}\\times\\texttt{Prev}\n\\end{align}\n$$ {#eq-mediator2}\n\n$$\n\\begin{align}\n\\mathsf{E}(\\texttt{MF}) &= \\alpha_0 + \\alpha_1 \\texttt{Fram} + \\alpha_2\\texttt{Prom} + \\alpha_3 \\texttt{Prev}\\\\&\\quad  + \\alpha_4 \\texttt{Fram}\\times\\texttt{Prom} +  \\alpha_5 \\texttt{Fram}\\times\\texttt{Prev}\n\\end{align}\n$$ {#eq-mediator3}\n\n$$\n\\begin{align}\n\\mathsf{E}(\\texttt{Open}) &= \\gamma_0 + \\gamma_1 \\texttt{Fram} + \\gamma_2\\texttt{Prom} + \\gamma_3 \\texttt{Prev}\\\\&\\quad  + \\gamma_4 \\texttt{Fram}\\times\\texttt{Prom} +  \\gamma_5 \\texttt{Fram}\\times\\texttt{Prev} \\\\& +\\gamma_6 \\texttt{PF} + \\gamma_7\\texttt{ME} + \\gamma_8 \\texttt{MF} +  \\gamma_9\\texttt{CO} \\\\&\\quad+ \\gamma_{10} \\texttt{ME} \\times \\texttt{CO} + \n+ \\gamma_{11} \\texttt{PF} \\times \\texttt{CO} + \n+ \\gamma_{12} \\texttt{MF} \\times \\texttt{CO}\n\\end{align}\n$$ {#eq-response}\n\nyielding a total of 31 coefficients for $n=198$ observations.\n\n\n::: {.cell hash='moderatedmediation_cache/html/unnamed-chunk-1_b6eeb0a80969e19ad689e0d40354e89c'}\n\n```{.r .cell-code}\ndata(RH19_S1, package = \"hecedsm\")\nset.seed(80667)\njoint_reg <- function(data, indices = 1:nrow(data)){\n  mod1 <- lm(fairness ~ \n               regfocus * (promem + prevem), \n             data = data[indices,])\n  mod2 <- lm(engagement ~ \n               regfocus * (promem + prevem), \n             data = data[indices,])\n  mod3 <- lm(fluency ~ \n               regfocus * (promem + prevem), \n             data = data[indices,])\n  resp <- lm(dopenness ~\n               regfocus * (promem + prevem) +\n               (fairness + fluency + \n       engagement) * change,\n             data = data[indices,])\n  coefs <- c(coef(mod1), \n             coef(mod2), \n             coef(mod3), \n             coef(resp))\n  return(coefs)\n}\nnpboot <- boot::boot(\n  data = RH19_S1, \n  statistic = joint_reg,\n  R = 9999, # number of bootstrap replicates\n  sim = \"ordinary\")\nresults <- rbind(\n  npboot$t0, \n  apply(npboot$t, 2, \n        quantile, c(0.025, 0.975)))\n```\n:::\n\n\n\n<!--\ndag {\nbb=\"-2.916,-3.142,3.923,3.622\"\nM1 [pos=\"-1.766,-1.563\"]\nM2 [pos=\"-0.668,-1.294\"]\nM3 [pos=\"0.661,-0.551\"]\nV1 [pos=\"-2.347,0.517\"]\nV2 [pos=\"1.302,-2.578\"]\nW [pos=\"1.957,1.681\"]\nX [exposure,pos=\"-1.332,1.514\"]\nY [outcome,pos=\"0.807,0.856\"]\nM1 -> Y\nM2 -> Y\nM3 -> Y\nV1 -> M1\nV1 -> M2\nV1 -> M3\nV1 -> Y\nV2 -> M1\nV2 -> M2\nV2 -> M3\nV2 -> Y\nW -> Y\nX -> M1\nX -> M2\nX -> M3\nX -> Y\n}\n-->\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntestImplications <- function( covariance.matrix, sample.size ){\n\tlibrary(ggm)\n\ttst <- function(i){ pcor.test( pcor(i,covariance.matrix), length(i)-2, sample.size )$pvalue }\ntos <- function(i){ paste(i,collapse=\" \") }\nimplications <- list(c(\"M1\",\"M2\",\"V1\",\"V2\",\"X\"),\n\t\tc(\"M1\",\"M3\",\"V1\",\"V2\",\"X\"),\n\t\tc(\"M1\",\"W\"),\n\t\tc(\"M2\",\"M3\",\"V1\",\"V2\",\"X\"),\n\t\tc(\"M2\",\"W\"),\n\t\tc(\"M3\",\"W\"),\n\t\tc(\"V1\",\"V2\"),\n\t\tc(\"V1\",\"W\"),\n\t\tc(\"V1\",\"X\"),\n\t\tc(\"V2\",\"W\"),\n\t\tc(\"V2\",\"X\"),\n\t\tc(\"W\",\"X\"))\n\tdata.frame( implication=unlist(lapply(implications,tos)),\n\t\tpvalue=unlist( lapply( implications, tst ) ) )\n\n}\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}