{
  "hash": "33eb6b9739dc0c4d8221e8da4ddfdeee",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Linear mediation model\"\ntype: docs\neditor_options: \n  chunk_output_type: console\n---\n\n\n\nDownload the [**R** code](/example/linearmediation.R) and the [SPSS code](/example/linearmediation.sps).\n\nConsider linear regression models in a system where some response variable $Y$ depends on a mediator, $M$, and an experimental factor, $X \\in \\{0,1\\}$.\nThe mediator model has expected value\n$$\nM = \\underset{\\text{intercept}}{c_M} + \\alpha X + \\underset{\\text{control variates}}{\\boldsymbol{Z}_M^\\top\\boldsymbol{\\delta}} + \\underset{\\text{error term}}{\\varepsilon_M}\n$$ {#eq-mediator-model}\nwhile we have for the response\n$$\nY = \\underset{\\text{intercept}}{c_Y} + \\underset{\\text{direct effect}}{\\beta X} + \\gamma M + \\underset{\\text{control variates}}{\\boldsymbol{Z}_Y^\\top\\boldsymbol{\\omega}}  + \\underset{\\text{error term}}{\\varepsilon_Y}, \\label{eq-responsemodel}\n$$ {#eq-response-model}\nThe explanatory variables $\\boldsymbol{Z}_M$ for the mediator model of @eq-mediator-model, and $\\boldsymbol{Z}_Y$ for the response model @eq-response-model are control covariates to account for confounders, and need not be the same in both models (but could be). In a randomized experiment where we manipulate the mediator, there is no need to include any control in @eq-mediator-model lest we mistakenly create correlation by including colliders. The error terms $\\varepsilon_Y$ and $\\varepsilon_M$ are assumed to be independent mean-zero with common variance.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Directed acyclic graph for the linear mediation model.](linearmediation_files/figure-html/fig-dag-linearmed-1.png){#fig-dag-linearmed fig-align='center' width=60%}\n:::\n:::\n\n\n\nIn the linear mediation model defined above and represented in @fig-dag-linearmed, the total effect of $X$ on $Y$ is $\\beta + \\alpha \\gamma$ (the average treatment effect, looking at the difference in response between treatment $X=1$ and control $X=0$).\n\nThe average causal mediation effect (ACME) or natural indirect effect for treatment at level $x$ is obtained by changing the potential outcome $Y_i\\{X, M_i(X)\\}$ of individual $i$ for the mediator $M_i(X)$ while fixing the treatment level $X$ to $x$, so \n\\begin{align*}\n\\mathsf{ACME} = \\mathsf{E}[Y_i\\{x, M_i(1)\\} - Y_i\\{x, M_i(0)\\}].\n\\end{align*}\nIn the linear mediation model, we get subtituting the value of $M$ from equation @eq-mediator-model into @eq-response-model\n$$\\begin{align*}\n\\mathsf{E}[Y_i\\{x, M_i(1)\\}]  &= \\underset{\\text{intercept}}{c_Y + \\gamma c_M} + \\underset{\\text{ACME}}{\\alpha\\gamma} + \\beta x+ \\underset{\\text{effect of control variates}}{\\gamma\\boldsymbol{Z}_M^\\top\\boldsymbol{\\delta}  + \\boldsymbol{Z}_Y^\\top\\boldsymbol{\\omega}}\\\\\n\\mathsf{E}[Y_i\\{x, M_i(0)\\}]  &=\\underset{\\text{intercept}}{c_Y + \\gamma c_M} + \\beta x +\\underset{\\text{effect of control variates}}{\\gamma\\boldsymbol{Z}_M^\\top\\boldsymbol{\\delta}  + \\boldsymbol{Z}_Y^\\top\\boldsymbol{\\omega}}\\\\\n\\end{align*}\n$$\nso the average difference between the two equations is $\\mathsf{ACME} = \\alpha\\gamma$.\n\n\n# Example 1\n\nWe consider an example from Experiment 1 of @Bastian:2014, who experienced the effect of the effect of shared pain (through a manipulation) on bonding.\n\n> This effect of pain remained when controlling for age (p = .048), gender (p = .052), and group size (p = .050). None of these variables were significantly correlated with experimental condition (ps > .136) or perceived bonding (ps > .925). To determine whether the marginal tendency for the pain tasks to be viewed as more threatening than the control tasks mediated the effect of pain on perceived bonding, we conducted a bootstrap analysis (Preacher & Hayes, 2008) using 5,000 resamples. The results of this analysis revealed that threat was not a significant mediator, indirect effect = −0.11, SE = 0.09, 95% CI = [−0.34, 0.03].\n\nThere are several problems with the description: while it seems\nthat some covariate (age, gender, group size) were added to regression models, it is unclear whether they could be confounders, whether their effect is linear and in which (if any model they are included). Stating \"bootstrap analysis\" is the equivalent of \"running a statistical test\": so vague it could mean anything, and the fact the output is random does not help with reproducibility.\n\n\nThe response variable $Y$ is `bonding`, the experimental factor `condition` and `threat`, the average ALES subscale about the perception of the physical task, is the postulated mediator.\n\nWe use the `mediation` package [@mediationR] for the model; the package certainly isn't needed (nor the PROCESS macros) to run the bootstrap, which we could obtain with a single for-loop. However, it has utilities, notably for checking model assumptions, that are convenient. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mediation, quietly = TRUE)\ndata(BJF14_S1, package = \"hecedsm\")\n\nMsX <- lm(threat ~ condition + gender + groupsize + age, \n          data = BJF14_S1)\nYsXM <- lm(bonding ~ condition + threat + gender + groupsize + age,\n           data = BJF14_S1)\n```\n:::\n\n\n\n::: {#tbl-panel layout-ncol=2}\n\n\n\n::: {#tbl-responsecoefs .cell tbl-cap='outcome model'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 2.66 </td>\n   <td style=\"text-align:right;\"> 1.47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> condition [pain] </td>\n   <td style=\"text-align:right;\"> 0.66 </td>\n   <td style=\"text-align:right;\"> 0.32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> threat </td>\n   <td style=\"text-align:right;\"> -0.24 </td>\n   <td style=\"text-align:right;\"> 0.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> gender [female] </td>\n   <td style=\"text-align:right;\"> -0.02 </td>\n   <td style=\"text-align:right;\"> 0.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> group size </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-mediationcoefs .cell tbl-cap='mediation model'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -0.16 </td>\n   <td style=\"text-align:right;\"> 0.59 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> condition [pain] </td>\n   <td style=\"text-align:right;\"> 0.30 </td>\n   <td style=\"text-align:right;\"> 0.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> gender [female] </td>\n   <td style=\"text-align:right;\"> -0.05 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> group size </td>\n   <td style=\"text-align:right;\"> -0.07 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nCoefficients of the regression models\n:::\n\nBoth of the `threat` and `bonding` measures are average of Likert scales. We include the controls in the regression for the response to account for potential confounding between threat level and shared bonding: it is unclear whether the authors used the control covariates or whether these make sense.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(80667)\nlinmed <- mediate(\n  model.m = MsX,\n  model.y = YsXM,\n  sims = 1000L, # number of bootstrap simulations\n  boot = TRUE, # use bootstrap\n  boot.ci.type = \"perc\", # type of bootstrap: percentile\n  mediator = \"threat\", # name of mediator\n  treat = \"condition\", # name of treatment\n  control.value = \"Control\", # name of control (level of 'condition')\n  treat.value = \"Pain\") # name of treatment (level of 'condition')\nsummary(linmed)\n```\n:::\n\n::: {#tbl-mediation .cell tbl-cap='Linear causal mediation analysis: parameter estimates, nonparametric bootstrap 95% confidence intervals and p-values with the percentile method based on 5000 bootstrap samples.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> lower 95% CI </th>\n   <th style=\"text-align:right;\"> upper 95% CI </th>\n   <th style=\"text-align:right;\"> p-value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ACME </td>\n   <td style=\"text-align:right;\"> -0.071 </td>\n   <td style=\"text-align:right;\"> -0.363 </td>\n   <td style=\"text-align:right;\"> 0.146 </td>\n   <td style=\"text-align:right;\"> 0.548 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ADE </td>\n   <td style=\"text-align:right;\"> 0.660 </td>\n   <td style=\"text-align:right;\"> -0.012 </td>\n   <td style=\"text-align:right;\"> 1.257 </td>\n   <td style=\"text-align:right;\"> 0.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> total effect </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 0.012 </td>\n   <td style=\"text-align:right;\"> 1.145 </td>\n   <td style=\"text-align:right;\"> 0.048 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> prop. mediated </td>\n   <td style=\"text-align:right;\"> -0.121 </td>\n   <td style=\"text-align:right;\"> -1.501 </td>\n   <td style=\"text-align:right;\"> 0.615 </td>\n   <td style=\"text-align:right;\"> 0.564 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nThe first line of @tbl-mediation gives the average reverse natural indirect effect or average conditional mediated effect (labelled ACME), the second the average direct effect (ADE) and the third the total effect (ADE + ACME). The point estimate for ACME, $\\alpha\\gamma$ is $\\widehat{\\alpha}\\widehat{\\gamma} = -0.07$.\nThe bootstrap sampling distribution is skewed to the left, a fact reflected by the asymmetric percentile confidence interval.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Density of the 1000 nonparametric bootstrap estimates of the average conditional mediation effect $\\alpha\\gamma$, with point estimate and 95% percentile bootstrap confidence intervals (vertical dashed lines).](linearmediation_files/figure-html/fig-densityACME-1.png){#fig-densityACME width=672}\n:::\n:::\n\n\n\n\n\nThe sequential ignorability assumption cannot be verified, but we can see what impacts violations would have on the coefficients: the expected value of the coefficient $\\widehat{\\gamma}$ is $\\gamma + \\mathsf{Cov}(\\varepsilon_M, \\varepsilon_Y)/\\mathsf{Va}(\\varepsilon_M)$; the second component is a bias term that does not vanish, even when the sample size grows [@Bullock.Green.Ha:2010]. The variance of the error of the mediation and response models can be estimated, and we can vary the correlation coefficient, $\\rho=\\mathsf{Cor}(\\varepsilon_M, \\varepsilon_Y)$, to assess the sensitivity of our conclusions if there was confounding.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinmed_sensitivity <- medsens(linmed)\nsummary(linmed_sensitivity)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMediation Sensitivity Analysis for Average Causal Mediation Effect\n\nSensitivity Region\n\n      Rho    ACME 95% CI Lower 95% CI Upper R^2_M*R^2_Y* R^2_M~R^2_Y~\n[1,] -0.4  0.2533      -0.0236       0.5302         0.16       0.1144\n[2,] -0.3  0.1626      -0.0723       0.3975         0.09       0.0644\n[3,] -0.2  0.0805      -0.1288       0.2898         0.04       0.0286\n[4,] -0.1  0.0034      -0.1969       0.2037         0.01       0.0072\n[5,]  0.0 -0.0714      -0.2788       0.1360         0.00       0.0000\n[6,]  0.1 -0.1462      -0.3748       0.0825         0.01       0.0072\n[7,]  0.2 -0.2233      -0.4850       0.0385         0.04       0.0286\n\nRho at which ACME = 0: -0.1\nR^2_M*R^2_Y* at which ACME = 0: 0.01\nR^2_M~R^2_Y~ at which ACME = 0: 0.0072 \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(linmed_sensitivity)\n```\n\n::: {.cell-output-display}\n![](linearmediation_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\nThe `medsens` function implements the sensitivity diagnostic presented in Section 5.1 of @Imai.Keele.Yamamoto:2010 for the linear mediation model. By default, the correlation $\\rho$ varies in 0.1 increments. We can see the wide range of the ACME if there was correlation between residuals from the mediation and the response model, highlighting the wide range of values that could be returned: the ACME could go from $0.2$ to $-0.288$ for correlations in the range $\\rho \\in [-0.4, 0.4]$.  In this example, nearly any correlation in this range would lead to \"insignificant results\", mostly because of the small sample size. In a situation where we had found a significant (sic) result, we could observe how much correlation btween would be needed for this effect to be an artefact of correlation and vanish.\n\nAccording to the documentation of the `medsens` function (`?medsens`), there are two variants of the estimated effect size, either computing the proportion of the total (tilde, `R^2_M~R^2_Y`) or residual (starred, `R^2_M*R^2_Y*`) variance from the mediation and outcome models that are due to hypothetical unobserved confounders. \n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}