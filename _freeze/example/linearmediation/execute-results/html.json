{
  "hash": "d1df0867f47d15a90a637ad7b358fc21",
  "result": {
    "markdown": "---\ntitle: \"Linear mediation model\"\ntype: docs\neditor_options: \n  chunk_output_type: console\n---\n\n\nConsider linear regression models in a system where some response $Y$ depends on a mediator is $M$ and an experimental factor is $X$.\nWe consider estimation of linear mediation models of the form\n\\begin{align*}\nM \\mid X, \\boldsymbol{Z}_M &= c_M + \\alpha X + \\boldsymbol{Z}_M^\\top\\boldsymbol{\\delta} + \\varepsilon_M\\\\\nY \\mid M, X, \\boldsymbol{Z}_Y&= c_Y + \\beta X + \\gamma M + \\boldsymbol{Z}_Y^\\top\\boldsymbol{\\omega} + \\varepsilon_Y,\n\\end{align*}\nwhere $\\boldsymbol{Z}_M$ (respectively $\\boldsymbol{Z}_Y$) are explanatory variables for the mediator $M$ (response $Y$). \n\n\n::: {.cell layout-align=\"center\" hash='linearmediation_cache/html/fig-dag-linearmed_cf15d950cc901d69e0bbb64fc2ccee6e'}\n::: {.cell-output-display}\n![Directed acyclic graph for linear mediation model.](linearmediation_files/figure-html/fig-dag-linearmed-1.png){#fig-dag-linearmed fig-align='center' width=2100}\n:::\n:::\n\n\nThe total effect of $X$ on $Y$ is $\\beta + \\alpha \\gamma$.\n\nThe average causal mediation effect (ACME) or natural indirect effect for treatment at level $t$ is obtained by changing the potential outcome for the mediator while fixing the treatment level, so \n\\begin{align*}\n\\mathsf{E}[Y_i\\{t, M_i(1)\\} - Y_i\\{t, M_i(0)\\}].\n\\end{align*}\n\nThe set of control covariates for the first model $\\boldsymbol{Z}_M$ and $\\boldsymbol{Z}_Y$, need not be the same. In a randomized experiment, there is no need to include any control lest we mistakenly create correlation by including colliders.\n\n# Example 1\n\nWe consider an example from Experiment 1 of @Bastian:2014, who experienced the effect of the effect of shared pain (through a manipulation) on bonding.\n\n> This effect of pain remained when controlling for age (p = .048), gender (p = .052), and group size (p = .050). None of these variables were significantly correlated with experimental condition (ps > .136) or perceived bonding (ps > .925). To determine whether the marginal tendency for the pain tasks to be viewed as more threatening than the control tasks mediated the effect of pain on perceived bonding, we conducted a bootstrap analysis (Preacher & Hayes, 2008) using 5,000 resamples. The results of this analysis revealed that threat was not a significant mediator, indirect effect = −0.11, SE = 0.09, 95% CI = [−0.34, 0.03].\n\nThere are several problems with the description: while it seems\nthat some covariate (age, gender, group size) were added to regression models, it is unclear whether they could be confounders, whether their effect is linear and in which (if any model they are included). Stating \"bootstrap analysis\" is the equivalent of \"running a statistical test\": so vague it could mean anything, and the fact the output is random does not help with reproducibility.\n\n\nThe response variable $Y$ is `bonding`, the experimental factor `condition` and `threat`, the average ALES subscale about the perception of the physical task, is the postulated mediator.\n\nWe use the `mediation` package [@mediationR] for the model; the package certainly isn't needed (nor the PROCESS macros) to run the bootstrap, which we could obtain with a single for-loop. However, it has utilities, notably for checking model assumptions, that are convenient. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mediation, quietly = TRUE)\ndata(BJF14_S1, package = \"hecedsm\")\n\nMsX <- lm(threat ~ condition +\n            gender + groupsize + age, \n          data = BJF14_S1)\nYsXM <- lm(bonding ~ threat + \n             gender + groupsize + age +\n             condition,\n           data = BJF14_S1)\n```\n:::\n\n::: {#tbl-mediationcoefs .cell layout-ncol=\"2\" tbl-cap='Coefficients of the mediation (left) and outcome (right) models.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"kable_wrapper table\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td> \n\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -0.16 </td>\n   <td style=\"text-align:right;\"> 0.59 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> consistency </td>\n   <td style=\"text-align:right;\"> 0.30 </td>\n   <td style=\"text-align:right;\"> 0.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> genderFemale </td>\n   <td style=\"text-align:right;\"> -0.05 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> groupsize </td>\n   <td style=\"text-align:right;\"> -0.07 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n  </tr>\n</tbody>\n</table>\n\n </td>\n   <td> \n\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 2.66 </td>\n   <td style=\"text-align:right;\"> 1.47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> condition [pain] </td>\n   <td style=\"text-align:right;\"> -0.24 </td>\n   <td style=\"text-align:right;\"> 0.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> gender [female] </td>\n   <td style=\"text-align:right;\"> -0.02 </td>\n   <td style=\"text-align:right;\"> 0.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> groupsize </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> conditionPain </td>\n   <td style=\"text-align:right;\"> 0.66 </td>\n   <td style=\"text-align:right;\"> 0.32 </td>\n  </tr>\n</tbody>\n</table>\n\n </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nBoth of the `threat` and `bonding` measures are average of Likert scales. We include the controls in the regression for the response to account for potential confounding between threat level and shared bonding: it is unclear whether the authors used the control covariates or whether these make sense.\n\n\n::: {.cell hash='linearmediation_cache/html/unnamed-chunk-4_b2dd069ab5a6f1c26c2dcdbe6c010077'}\n\n```{.r .cell-code}\nset.seed(80667)\nlinmed <- mediate(\n  model.m = MsX,\n  model.y = YsXM,\n  sims = 1000L, # number of bootstrap sim\n  boot = TRUE, # use bootstrap\n  boot.ci.type = \"perc\", #percentile bootstrap\n  mediator = \"threat\", #name of mediator\n  treat = \"condition\", #name of treatment\n  control.value = \"Control\", # name of control level\n  treat.value = \"Pain\")\nsummary(linmed)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCausal Mediation Analysis \n\nNonparametric Bootstrap Confidence Intervals with the Percentile Method\n\n               Estimate 95% CI Lower 95% CI Upper p-value  \nACME            -0.0714      -0.3631         0.15   0.548  \nADE              0.6598      -0.0117         1.26   0.056 .\nTotal Effect     0.5884       0.0123         1.14   0.048 *\nProp. Mediated  -0.1213      -1.5011         0.62   0.564  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nSample Size Used: 54 \n\n\nSimulations: 1000 \n```\n:::\n:::\n\n\n\nThe first line gives the average reverse natural indirect effect or average conditional mediated effect (labelled ACME), the second the average direct effect and the third the total effect. The point estimate for the indirect effect is $\\alpha\\gamma$ or `r `coef(YsXM)['threat'] * coef(MsX)['conditionPain']` which is -0.07.\nThe bootstrap sampling distribution is skewed to the left, which is reflected in the asymmetry of the percentile confidence interval.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Density of the 1000 nonparametric bootstrap estimates of the average conditional mediation effect $\\alpha\\gamma$.](linearmediation_files/figure-html/fig-densityACME-1.png){#fig-densityACME width=672}\n:::\n:::\n\n\n\n\nThe sequential ignorability assumption cannot be verified, but we can see what impacts violations would have on the coefficients: the expected value of the (least square) coefficient $\\widehat{\\gamma}$ is $\\gamma + \\mathsf{Co}(\\varepsilon_1, \\varepsilon_3)/\\mathsf{Va}(\\varepsilon_1)$ [@Bullock.Green.Ha:2010]. The variance of the error of the mediation can be estimated and we can vary the correlation due to confounding.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinmed_sensitivity <- medsens(linmed)\nsummary(linmed_sensitivity)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMediation Sensitivity Analysis for Average Causal Mediation Effect\n\nSensitivity Region\n\n      Rho    ACME 95% CI Lower 95% CI Upper R^2_M*R^2_Y* R^2_M~R^2_Y~\n[1,] -0.4  0.2533      -0.0236       0.5302         0.16       0.1144\n[2,] -0.3  0.1626      -0.0723       0.3975         0.09       0.0644\n[3,] -0.2  0.0805      -0.1288       0.2898         0.04       0.0286\n[4,] -0.1  0.0034      -0.1969       0.2037         0.01       0.0072\n[5,]  0.0 -0.0714      -0.2788       0.1360         0.00       0.0000\n[6,]  0.1 -0.1462      -0.3748       0.0825         0.01       0.0072\n[7,]  0.2 -0.2233      -0.4850       0.0385         0.04       0.0286\n\nRho at which ACME = 0: -0.1\nR^2_M*R^2_Y* at which ACME = 0: 0.01\nR^2_M~R^2_Y~ at which ACME = 0: 0.0072 \n```\n:::\n\n```{.r .cell-code}\nplot(linmed_sensitivity)\n```\n\n::: {.cell-output-display}\n![](linearmediation_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nThe `medsens` function implements the sensitivity diagnostic presented in Section 5.1 of @Imai.Keele.Yamamoto:2010 for the linear mediation model. By default, the correlation $\\rho$ varies in 0.1 increments.\n\nWe can see the wide range of the ACME if there was correlation between residuals from the mediation and the response model, highlighting the wide range of values that could be returned: the ACME could go from $0.2$ to $-0.288$ for correlations in the range $\\rho \\in [-0.4, 0.4]$.  In this example, nearly any correlation in this range would lead to \"insignificant results\", mostly because of the small sample size. In a situation where we had found a significant (sic) result, we could observe how much correlation would be needed for this effect to be an artefact of correlation and vanish.\n\nAccording to the documentation of the `medsens` function (`?medsens`), there are two variants of the estimated effect size, either computing the proportion of the total (tilde, `R^2_M~R^2_Y`) or residual (starred, `R^2_M*R^2_Y*`) variance from the mediation and outcome models that are due to hypothetical unobserved confounders. \n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/bsTable-3.3.7/bootstrapTable.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/bsTable-3.3.7/bootstrapTable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}